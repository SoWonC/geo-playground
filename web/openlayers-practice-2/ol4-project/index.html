<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>OL4 WMS/WFS · 정돈된 UI</title>

    <!-- OL4 CDN -->
    <link rel="stylesheet" href="https://openlayers.org/en/v4.6.5/css/ol.css" />
    <script src="https://openlayers.org/en/v4.6.5/build/ol.js"></script>

    <style>
        html, body { height: 100%; margin: 0; }
        body { font: 13px/1.4 Arial, sans-serif; color: #222; }

        /* 전체 2열 레이아웃: 좌측 사이드바, 우측 지도 */
        .app {
            display: grid;
            grid-template-columns: 300px 1fr;
            grid-template-rows: 100%;
            height: 100%;
            width: 100%;
        }

        /* ===== 좌측 사이드바 ===== */
        .sidebar {
            border-right: 1px solid #e5e5e5;
            background: #fafafa;
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding: 12px;
            overflow: auto; /* 내용 길어지면 스크롤 */
        }

        .toolbar {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 8px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.06);
        }
        .toolbar h3 {
            grid-column: 1 / -1;
            margin: 0 0 4px 0; font-size: 13px; color: #555;
        }
        .toolbar button, .toolbar label {
            border: 1px solid #cfcfcf;
            background: #fff;
            border-radius: 6px;
            padding: 6px 8px;
            cursor: pointer;
            display: inline-flex; align-items: center; justify-content: center;
        }
        .toolbar button:active { transform: translateY(1px); }
        .row-span { grid-column: 1 / -1; } /* 한 줄 전체 쓰기 */
        .range { width: 100%; }

        .panel {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.06);
        }
        .panel header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 6px;
        }
        .panel header h3 { margin: 0; font-size: 14px; color: #555; }
        .panel .body { max-height: 280px; overflow: auto; }
        .panel pre { margin: 0; white-space: pre-wrap; word-break: break-word; }
        .muted { color: #777; }

        /* ===== 우측 지도 영역 ===== */
        .map-wrap {
            position: relative;
            background: #fff;
        }
        #map { position: absolute; inset: 0; } /* 꽉 채우기 */

        /* 하단 HUD(좌표/스케일바) */
        .hud {
            position: absolute; right: 10px; bottom: 10px; z-index: 1200;
            display: flex; flex-direction: column; gap: 6px; align-items: flex-end;
        }
        .pill {
            background: rgba(255,255,255,0.95);
            border: 1px solid #ddd; border-radius: 8px;
            padding: 6px 8px;
        }

        /* 인덱스맵(OverviewMap): 지도 내부 좌하단 (사이드바와 분리라 겹침 없음) */
        .ol-overviewmap {
            position: absolute;
            left: 10px; bottom: 10px; top: auto; right: auto;
            z-index: 1100;
        }
        .ol-overviewmap .ol-overviewmap-map { width: 180px; height: 130px; }
    </style>
</head>
<body>
<div class="app">
    <!-- 좌: 컨트롤/정보 -->
    <aside class="sidebar">
        <div class="toolbar">
            <h3>지도 컨트롤</h3>
            <button id="zoomIn">＋ 줌인</button>
            <button id="zoomOut">－ 줌아웃</button>
            <button id="reset" class="row-span">Reset 뷰</button>

            <label><input type="checkbox" id="toggleWMS" checked> WMS On/Off</label>
            <label><input type="checkbox" id="toggleWFS" checked> WFS On/Off</label>
            <!-- 그리기/수정/지우기/저장 -->
            <button id="drawPoint" class="row-span">점 그리기</button>
            <button id="drawLine"  class="row-span">선 그리기</button>
            <button id="drawPoly"  class="row-span">폴리곤 그리기</button>
            <button id="toggleModify" class="row-span">수정 모드 켜기</button>
            <button id="clearAll" class="row-span">전체 지우기</button>
            <button id="saveImage" class="row-span">이미지 저장</button>

            <label class="row-span">WMS 투명도
                <input type="range" id="opacity" class="range" min="0" max="1" step="0.05" value="1">
            </label>
        </div>

        <div class="panel" id="infoPanel">
            <header>
                <h3>속성 정보</h3>
                <button id="collapse">접기</button>
            </header>
            <div class="body" id="infoBody">
                <span class="muted">지도를 클릭하면 WMS GetFeatureInfo 또는 WFS 선택 결과가 여기에 표시됩니다.</span>
            </div>
        </div>
    </aside>

    <!-- 우: 지도 -->
    <main class="map-wrap">
        <div id="map"></div>
        <div class="hud">
            <div id="mousePos" class="pill">Lon,Lat: -, -</div>
            <div id="scaleWrap" class="pill"></div>
        </div>
    </main>
</div>

<!-- 앱 스크립트 -->
<script src="main.js"></script>
</body>
</html>
